<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEDDLib: /home/user/Programme/opt/FEDDLib/FEEDLIB_LEA/source/FEDDLib/feddlib/core/FE/Domain_def.hpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FEDDLib
   </div>
   <div id="projectbrief">Finite Element Domain Decomposition Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_a7abe54e76939ade77b37861375e4c18.html">feddlib</a></li><li class="navelem"><a class="el" href="../../dir_4d2a120ed35eb3406b5c375f9d7da577.html">core</a></li><li class="navelem"><a class="el" href="../../dir_cca3d899a5b22ec00121405cbdbebcb5.html">FE</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Domain_def.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef Domain_def_hpp</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define Domain_def_hpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;Domain_decl.hpp&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d0/dac/namespaceFEDD.html">FEDD</a> {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Domain&lt;SC,LO,GO,NO&gt;::Domain():</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;comm_(),</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;mesh_(),</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;mapVecFieldUnique_(),</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;mapVecFieldRepeated_(),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;geometries2DVec_(),</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;geometries3DVec_(),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;distancesToInterface_(),</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;interfaceMapUnique_(),</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;interfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;globalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;globalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;partialGlobalInterfaceVecFieldMap_(),</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;otherGlobalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;otherGlobalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;otherPartialGlobalInterfaceVecFieldMap_()</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;Domain&lt;SC,LO,GO,NO&gt;::Domain(CommConstPtr_Type comm):</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;comm_(comm),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;mesh_(),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;mapVecFieldUnique_(),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;mapVecFieldRepeated_(),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;geometries2DVec_(),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;geometries3DVec_(),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;distancesToInterface_(),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;interfaceMapUnique_(),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;interfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;globalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;globalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;partialGlobalInterfaceVecFieldMap_(),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;otherGlobalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;otherGlobalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;otherPartialGlobalInterfaceVecFieldMap_()</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;Domain&lt;SC,LO,GO,NO&gt;::Domain(CommConstPtr_Type comm, <span class="keywordtype">int</span> dimension):</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;comm_(comm),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;mesh_(),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;dim_(dimension),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;mapVecFieldUnique_(),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;mapVecFieldRepeated_(),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;geometries2DVec_(),</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;geometries3DVec_(),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;distancesToInterface_(),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;interfaceMapUnique_(),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;interfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;globalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;globalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;partialGlobalInterfaceVecFieldMap_(),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;otherGlobalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;otherGlobalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;otherPartialGlobalInterfaceVecFieldMap_()</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;Domain&lt;SC,LO,GO,NO&gt;::Domain(vec_dbl_Type coor, <span class="keywordtype">double</span> l, <span class="keywordtype">double</span> h, CommConstPtr_Type comm):</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;comm_(comm),</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;mesh_(),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;mapVecFieldUnique_(),</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;mapVecFieldRepeated_(),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;geometries2DVec_(),</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;geometries3DVec_(),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;distancesToInterface_(),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;interfaceMapUnique_(),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;interfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;globalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;globalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;partialGlobalInterfaceVecFieldMap_(),</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    otherGlobalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    otherGlobalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    otherPartialGlobalInterfaceVecFieldMap_()</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    coorRec = coor;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    length  = l;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    height  = h;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    width = -1;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    geometries2DVec_.reset(<span class="keyword">new</span> string_vec_Type(0));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    geometries2DVec_-&gt;push_back(<span class="stringliteral">&quot;Square&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    geometries2DVec_-&gt;push_back(<span class="stringliteral">&quot;BFS&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    geometries2DVec_-&gt;push_back(<span class="stringliteral">&quot;SquareTPM&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    geometries2DVec_-&gt;push_back(<span class="stringliteral">&quot;structuredMiniTest&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//    geometries2DVec-&gt;push_back(&quot;REC&quot;);</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;Domain&lt;SC,LO,GO,NO&gt;::Domain(vec_dbl_Type coor, <span class="keywordtype">double</span> l, <span class="keywordtype">double</span> w, <span class="keywordtype">double</span> h, CommConstPtr_Type comm):</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;comm_(comm),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;mesh_(),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;mapVecFieldUnique_(),</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;mapVecFieldRepeated_(),</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;geometries2DVec_(),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;geometries3DVec_(),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;distancesToInterface_(),</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;interfaceMapUnique_(),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;interfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;globalInterfaceMapUnique_(),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;globalInterfaceMapVecFieldUnique_(),</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;partialGlobalInterfaceVecFieldMap_()</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    coorRec = coor;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    length  = l;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    width   = w;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    height  = h;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    geometries3DVec_.reset(<span class="keyword">new</span> string_vec_Type(0));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    geometries3DVec_-&gt;push_back(<span class="stringliteral">&quot;Square&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    geometries3DVec_-&gt;push_back(<span class="stringliteral">&quot;BFS&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::info(){</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    LO minNumberNodes;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    LO maxNumberNodes;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    LO numberNodes = this-&gt;getMapUnique()-&gt;getNodeNumElements();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    Teuchos::reduceAll( *this-&gt;comm_, Teuchos::REDUCE_MIN, numberNodes, Teuchos::ptrFromRef(minNumberNodes) );</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    Teuchos::reduceAll( *this-&gt;comm_, Teuchos::REDUCE_MAX, numberNodes, Teuchos::ptrFromRef(maxNumberNodes) );</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">bool</span> verbose(comm_-&gt;getRank()==0);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Domain ###&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Dimension: &quot;</span>&lt;&lt; dim_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Mesh type: &quot;</span>&lt;&lt; meshType_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Mesh flags: &quot;</span>&lt;&lt; flagsOption_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Subdomains: &quot;</span>&lt;&lt; n_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### H/h: &quot;</span>&lt;&lt; m_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### FE type: &quot;</span>&lt;&lt; FEType_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Number Nodes: &quot;</span>&lt;&lt; mesh_-&gt;getMapUnique()-&gt;getMaxAllGlobalIndex()+1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Minimum number of nodes: &quot;</span>&lt;&lt; minNumberNodes &lt;&lt; <span class="stringliteral">&quot;  Maximum number of nodes: &quot;</span> &lt;&lt; maxNumberNodes &lt;&lt; std::endl;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\t### Empty ranks for coarse solves: &quot;</span>&lt;&lt; numProcsCoarseSolve_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::initializeFEData(){</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    this-&gt;getElementsC()-&gt;initializeFEData( this-&gt;getPointsRepeated() );</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::setMeshParameterList( ParameterListPtr_Type&amp; pl ){</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    TEUCHOS_TEST_FOR_EXCEPTION( mesh_.is_null(), std::runtime_error, <span class="stringliteral">&quot;Mesh is null.&quot;</span> );</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    mesh_-&gt;setParameterList( pl );</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;vec_int_ptr_Type Domain&lt;SC,LO,GO,NO&gt;::getElementsFlag()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getElementsFlag();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;LO Domain&lt;SC,LO,GO,NO&gt;::getApproxEntriesPerRow()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (this-&gt;dim_ == 2) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> ( this-&gt;FEType_ == <span class="stringliteral">&quot;P1&quot;</span> ) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">return</span> 24;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( this-&gt;FEType_ == <span class="stringliteral">&quot;P2&quot;</span> ) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">return</span> 48;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">return</span> 40;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> ( this-&gt;FEType_ == <span class="stringliteral">&quot;P1&quot;</span> ) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">return</span> 100;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( this-&gt;FEType_ == <span class="stringliteral">&quot;P2&quot;</span> ) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">return</span> 160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">return</span> 100;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::buildMesh(<span class="keywordtype">int</span> flagsOption , std::string meshType, <span class="keywordtype">int</span> dim, std::string FEType, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> numProcsCoarseSolve){</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">int</span> geoNumber = checkGeomentry(meshType, dim);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#ifdef ASSERTS_WARNINGS</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    MYASSERT(geoNumber!=-1, <span class="stringliteral">&quot;Geometry not known for this Dimension.&quot;</span>)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    MeshStrPtr_Type meshStructured = Teuchos::rcp(<span class="keyword">new</span> MeshStr_Type(comm_));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    n_ = N;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    m_ = M;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    dim_ = dim;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    FEType_ = FEType;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    numProcsCoarseSolve_ = numProcsCoarseSolve;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    meshType_ = meshType;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    flagsOption_ = flagsOption;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">switch</span> (dim) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">switch</span> (geoNumber) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    meshStructured-&gt;setGeometry2DRectangle(coorRec, length, height);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    meshStructured-&gt;buildMesh2D(FEType, n_, m_, numProcsCoarseSolve);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    meshStructured-&gt;setGeometry2DRectangle(coorRec, length, height);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    meshStructured-&gt;buildMesh2DBFS(FEType, n_, m_, numProcsCoarseSolve);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    meshStructured-&gt;setGeometry2DRectangle(coorRec, length, height);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    meshStructured-&gt;buildMesh2DTPM(FEType, n_, m_, numProcsCoarseSolve);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    meshStructured-&gt;setGeometry2DRectangle(coorRec, length, height);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    meshStructured-&gt;buildMesh2DMiniTPM(FEType, n_, m_, numProcsCoarseSolve);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>,std::logic_error,<span class="stringliteral">&quot;Select valid mesh. Structured types are &#39;structured&#39; and &#39;structured_bfs&#39; in 2D. TPM test meshes also available.&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">switch</span> (geoNumber) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    meshStructured-&gt;setGeometry3DBox(coorRec, length, width, height);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    meshStructured-&gt;buildMesh3D( FEType, n_, m_, numProcsCoarseSolve);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    meshStructured-&gt;setGeometry3DBox(coorRec, length, width, height);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    meshStructured-&gt;buildMesh3DBFS( FEType, n_, m_, numProcsCoarseSolve);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>,std::runtime_error,<span class="stringliteral">&quot;Select valid mesh. Structured types are &#39;structured&#39; and &#39;structured_bfs&#39; in 3D.&quot;</span> );</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>,std::logic_error,<span class="stringliteral">&quot;Select valid mesh dimension. 2 or 3 dimensional meshes can be constructed.&quot;</span>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    meshStructured-&gt;buildElementMap();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    meshStructured-&gt;setStructuredMeshFlags(flagsOption,FEType);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    mesh_ = meshStructured;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::initializeUnstructuredMesh(<span class="keywordtype">int</span> dimension, <span class="keywordtype">string</span> feType, <span class="keywordtype">int</span> volumeID){</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp(<span class="keyword">new</span> MeshUnstr_Type(comm_, volumeID));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    mesh_ = meshUnstructured;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    mesh_-&gt;dim_ = dimension;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    FEType_ = feType;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    meshType_ = <span class="stringliteral">&quot;unstructured&quot;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    numProcsCoarseSolve_ = 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    n_ = comm_-&gt;getSize() - numProcsCoarseSolve_;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    m_ = -1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    flagsOption_ = -1;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::readMeshSize(<span class="keywordtype">string</span> filename, <span class="keywordtype">string</span> delimiter){</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( mesh_ );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    TEUCHOS_TEST_FOR_EXCEPTION( meshUnstructured.is_null(), std::runtime_error, <span class="stringliteral">&quot;Unstructured Mesh is null.&quot;</span> );</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    meshUnstructured-&gt;setMeshFileName( filename, delimiter );</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    meshUnstructured-&gt;readMeshSize( );</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::partitionMesh( <span class="keywordtype">bool</span> partitionDistance ){</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( mesh_ );</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (partitionDistance)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        partitionDistanceToInterface();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    mesh_ = meshUnstructured;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::partitionDistanceToInterface( ){</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    vec_dbl_Type tmp = *distancesToInterface_;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    distancesToInterface_.reset( <span class="keyword">new</span> vec_dbl_Type ( mesh_-&gt;getMapRepeated()-&gt;getNodeNumElements() ) );</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">for</span> (UN i=0; i&lt;distancesToInterface_-&gt;size(); i++) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        GO index = mesh_-&gt;getMapRepeated()-&gt;getGlobalElement(i);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        distancesToInterface_-&gt;at(i) = tmp[index];</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::readAndPartitionMesh( std::string filename, std::string delimiter, <span class="keywordtype">int</span> dim, std::string FEType, <span class="keywordtype">int</span> volumeID ){</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp(<span class="keyword">new</span> MeshUnstr_Type(comm_, volumeID));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    dim_ = dim;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    FEType_ = FEType;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    mesh_ = meshUnstructured;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    mesh_-&gt;dim_ = dim_;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    numProcsCoarseSolve_ = 0;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    n_ = comm_-&gt;getSize() - numProcsCoarseSolve_;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    m_ = -1;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    flagsOption_ = -1;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    meshType_ = <span class="stringliteral">&quot;unstructured&quot;</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::buildP2ofP1Domain( DomainPtr_Type domainP1 ){ <span class="comment">//P1 mesh must be parallel</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    MeshUnstrPtr_Type meshUnstructuredP1 = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( domainP1-&gt;mesh_ );</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp( <span class="keyword">new</span> MeshUnstr_Type( comm_, meshUnstructuredP1-&gt;volumeID_) );</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    n_ = domainP1-&gt;n_;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    m_ = domainP1-&gt;m_;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    dim_ = domainP1-&gt;dim_;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    FEType_ = <span class="stringliteral">&quot;P2&quot;</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    numProcsCoarseSolve_ = 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    flagsOption_ = -1;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    meshType_ = <span class="stringliteral">&quot;unstructured&quot;</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    meshUnstructured-&gt;buildP2ofP1MeshEdge( meshUnstructuredP1 );</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    mesh_ = meshUnstructured;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;vec_dbl_Type Domain&lt;SC,LO,GO,NO&gt;::errorEstimation(MultiVectorPtrConst_Type valuesSolution, <span class="keywordtype">double</span> theta, <span class="keywordtype">string</span> strategy){</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// A-Posteriori Error Estimation, right now based in MeshUnstructuredRefinement, maybe reallocated later</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    MeshUnstrRefPtr_Type meshUnstrRef =Teuchos::rcp_dynamic_cast&lt;MeshUnstrRef_Type&gt;(mesh_, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    vec_dbl_Type errorElements = meshUnstrRef-&gt;errorEstimation(valuesSolution, theta, strategy);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span> errorElements;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::initMeshRef( DomainPtr_Type domainP1 ){ </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// Initialize MeshRefinementType as through other function like meshPartitioner and buildP2OfP1 Mesh meshUnstr Type is required</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    MeshUnstrPtr_Type meshUnstr = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( domainP1-&gt;mesh_ , <span class="keyword">true</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    MeshUnstrRefPtr_Type meshUnstrRefTmp = Teuchos::rcp( <span class="keyword">new</span> MeshUnstrRef_Type( comm_, meshUnstr-&gt;volumeID_, meshUnstr ) );</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    mesh_ = meshUnstrRefTmp;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::refineMesh(DomainPtrArray_Type domainsP1, <span class="keywordtype">int</span> j ,  <span class="keywordtype">bool</span> checkRestrictions, <span class="keywordtype">string</span> restriction){ </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// We pass on all previously refined meshes </span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// Useful for later coarsening of elements or determining restrictions of refinement strategies </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// i.e. no previously green refined element is refined green again</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    MeshUnstrRefPtr_Type meshUnstructuredRefined;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    MeshUnstrRefPtrArray_Type meshUnstructuredP1(j+1);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;j+1; i++)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        meshUnstructuredP1[i] = Teuchos::rcp_dynamic_cast&lt;MeshUnstrRef_Type&gt;( domainsP1[i]-&gt;mesh_ );</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    meshUnstructuredRefined = Teuchos::rcp( <span class="keyword">new</span> MeshUnstrRef_Type( comm_, meshUnstructuredP1[j]-&gt;volumeID_) );</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    n_ = domainsP1[j]-&gt;n_;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    m_ = domainsP1[j]-&gt;m_;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    dim_ = domainsP1[j]-&gt;dim_;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    FEType_ = domainsP1[j]-&gt;FEType_;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    numProcsCoarseSolve_ = 0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    flagsOption_ = -1;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    meshType_ = <span class="stringliteral">&quot;unstructured&quot;</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// refining the mesh</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    meshUnstructuredRefined-&gt;refineMesh(meshUnstructuredP1,j, checkRestrictions, restriction);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    mesh_ = meshUnstructuredRefined;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;UN Domain&lt;SC,LO,GO,NO&gt;::getDimension()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span> dim_;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;std::string Domain&lt;SC,LO,GO,NO&gt;::getFEType()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">return</span> FEType_;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::CommConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getComm()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">return</span> comm_;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMapUnique()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getMapUnique();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMapRepeated()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getMapRepeated();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;}</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMapUniqueP2()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getMapUniqueP2();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMapRepeatedP2()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getMapRepeatedP2();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getElementMap()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getElementMap();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getEdgeMap()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getEdgeMap();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;vec2D_dbl_ptr_Type Domain&lt;SC,LO,GO,NO&gt;::getPointsRepeated()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getPointsRepeated();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;vec2D_dbl_ptr_Type Domain&lt;SC,LO,GO,NO&gt;::getPointsUnique()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getPointsUnique();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;vec_int_ptr_Type Domain&lt;SC,LO,GO,NO&gt;::getBCFlagRepeated()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getBCFlagRepeated();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;vec_int_ptr_Type Domain&lt;SC,LO,GO,NO&gt;::getBCFlagUnique()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getBCFlagUnique();</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;vec2D_int_ptr_Type Domain&lt;SC,LO,GO,NO&gt;::getElements()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    TEUCHOS_TEST_FOR_EXCEPTION(mesh_-&gt;getElementsC().is_null(), std::runtime_error, <span class="stringliteral">&quot;Elements is null for this mesh.&quot;</span>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getElements();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::ElementsPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getElementsC()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    TEUCHOS_TEST_FOR_EXCEPTION(mesh_-&gt;getElementsC().is_null(), std::runtime_error, <span class="stringliteral">&quot;Elements is null for this mesh.&quot;</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getElementsC();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMapVecFieldUnique()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> ( mapVecFieldUnique_.is_null() ) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        MapConstPtr_Type mapTmp = this-&gt;getMapUnique();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        mapVecFieldUnique_ = mapTmp-&gt;buildVecFieldMap(dim_);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> mapVecFieldUnique_;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMapVecFieldRepeated()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">if</span> ( mapVecFieldRepeated_.is_null() ) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        MapConstPtr_Type mapTmp = this-&gt;getMapRepeated();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        mapVecFieldRepeated_ = mapTmp-&gt;buildVecFieldMap(dim_);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">return</span> mapVecFieldRepeated_;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;GO Domain&lt;SC,LO,GO,NO&gt;::getNumElementsGlobal()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getNumElementsGlobal();</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;}</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;LO Domain&lt;SC,LO,GO,NO&gt;::getNumElements()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getNumElements();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;LO Domain&lt;SC,LO,GO,NO&gt;::getNumPoints(std::string type)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> mesh_-&gt;getNumPoints(type);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;}</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordtype">int</span> Domain&lt;SC,LO,GO,NO&gt;::checkGeomentry(std::string meshType, <span class="keywordtype">int</span> dim)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">int</span> notfoundLabel;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">switch</span> (dim) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;geometries2DVec_-&gt;size(); i++) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                notfoundLabel = meshType.compare(geometries2DVec_-&gt;at(i));</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="keywordflow">if</span> (notfoundLabel==0) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;geometries3DVec_-&gt;size(); i++) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                notfoundLabel = meshType.compare(geometries3DVec_-&gt;at(i));</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="keywordflow">if</span> (notfoundLabel==0) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>,std::logic_error,<span class="stringliteral">&quot;Select valid geometry.&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::identifyInterfaceParallelAndDistance( DomainPtr_Type domainOther, vec_int_Type interfaceID_vec ){</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( mesh_ );</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    MeshUnstrPtr_Type meshUnstructuredOther = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( domainOther-&gt;mesh_ );</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    meshUnstructured-&gt;buildMeshInterfaceParallelAndDistance( meshUnstructuredOther, interfaceID_vec, distancesToInterface_ );</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">// Abstand zum Interface berechnen</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::calculateDistancesToInterface()</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// IdentifyInterface() ist nur fuer unstrukturierte Gitter programmiert</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// Mesh_-&gt;MeshInterface_ gibt es somit nicht.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( mesh_ );</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// Fuer jede Interface-Flag gibt es &quot;aussen&quot; einen Eintrag im Vektor.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// Wenn das Interface also fuer 2 Flags bestimmt wird, dann ist IndicesGlobalMatched_.size() = 2.</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Danach gibt es zwei Zeilenvektoren mit der globalen ID fuer this (thisMesh) und otherMesh,</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// also z.B. fuer Fluid (this) und Struktur (other).</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// Das heisst wir haben IndicesGlobalMatched_.at(0).size() = 2.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// Letztlich haben wir NumberOfInterfaceNodesWithFlag = IndicesGlobalMatched_.at(0).at(0).size().</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// In den Eintragen IndicesGlobalMatched_.at(0).at(0).at(i) steht die globale ID von Interfaceknoten i.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    vec3D_GO_ptr_Type indicesGlobalMatched = meshUnstructured-&gt;meshInterface_-&gt;getIndicesGlobalMatched();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// SourceNodes (z.B. Fluidgebiet) aus dem Gitter ziehen</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// Gefaehrlich, da Veraenderungen an SourceNodesRep auch PointsRep_ veraendern;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// Sonst auf 0.0 setzen und dann Werte reinschreiben.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">// Am besten waere es Getter zu haben mit return vec2D_dbl_ptr_Type bzw. const vec2vec2D_dbl_ptr_Type, damit nichts passieren kann.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    vec2D_dbl_ptr_Type sourceNodesRep = meshUnstructured-&gt;getPointsRepeated();</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// Zaehle mit Hilfe von indicesGlobalMatched wie viele Interfaceknoten es insgesamt gibt.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">int</span> numberInterfaceNodes = 0;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; indicesGlobalMatched-&gt;size(); i++) <span class="comment">// Schleife ueber jede Flag</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; indicesGlobalMatched-&gt;at(i).at(0).size(); j++) <span class="comment">// Schleife ueber jeden Interfaceknoten mit der Flag</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            numberInterfaceNodes = numberInterfaceNodes + 1;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// EndNodes (Interfaceknoten) aus dem Gitter ziehen; mit Hilfe von IndicesGlobalMatched</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    vec2D_dbl_ptr_Type endNodesRep(<span class="keyword">new</span> vec2D_dbl_Type( numberInterfaceNodes, vec_dbl_Type( dim_, 0.0 ) ) );</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">int</span> counter = 0; <span class="comment">// Die Zeile in die bei EndNodesRep hineingeschrieben wird</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">int</span> globalIDOfInterfaceNode;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; indicesGlobalMatched-&gt;size(); i++)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; indicesGlobalMatched-&gt;at(i).at(0).size(); j++)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="comment">// -&gt;at(i).at(0) ist this(z.B. Fluid) und -&gt;at(i).at(1) waere other (z.B. Struktur).</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            globalIDOfInterfaceNode = indicesGlobalMatched-&gt;at(i).at(0).at(j);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; dim_; k++) <span class="comment">// Schleife ueber x- und y-Koordinate und ggf. z</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                endNodesRep-&gt;at(counter).at(k) = meshUnstructured-&gt;getPointsRepeated()-&gt;at( globalIDOfInterfaceNode ).at( k );</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            counter = counter + 1;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// Distanz zum Interface auf eine unrealistisch grosse Zahl setzen.</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// In DistancesToInterface_-&gt;at(i) steht die Distanz der globalen Knoten-ID i zum Interface</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    vec_dbl_ptr_Type tempVec( <span class="keyword">new</span> vec_dbl_Type( meshUnstructured-&gt;getPointsRepeated()-&gt;size(), 1000.0 ) );</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    distancesToInterface_ = tempVec;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// Berechne nun den Abstand von den SourceNodesRep zu den EndNodesRep</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">double</span> distance = 0.0;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; sourceNodesRep-&gt;size(); i++)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; endNodesRep-&gt;size(); j++)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; dim_; k++)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                distance = distance + pow( sourceNodesRep-&gt;at(i).at(k) - endNodesRep-&gt;at(j).at(k), 2.0 );</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="comment">// Noch die Wurzel ziehen</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            distance = sqrt(distance);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordflow">if</span>(distancesToInterface_-&gt;at(i) &gt; distance)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                distancesToInterface_-&gt;at(i) = distance;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="comment">// Reseten</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            distance = 0.0;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;vec_dbl_ptr_Type Domain&lt;SC,LO,GO,NO&gt;::getDistancesToInterface()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">return</span> distancesToInterface_;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;}</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::setReferenceConfiguration()</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    mesh_-&gt;setReferenceConfiguration();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MeshPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMesh(){</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">return</span> mesh_;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;}</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MeshConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getMesh()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    MeshConstPtr_Type meshConst = mesh_;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">return</span> meshConst;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;}</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::moveMesh(MultiVectorPtr_Type displacementUnique, MultiVectorPtr_Type displacementRepeated)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;{</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    mesh_-&gt;moveMesh(displacementUnique, displacementRepeated);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">//only need in geometry problem.</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::buildUniqueInterfaceMaps()</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;{</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// Mesh_ umcasten  in unstructured und dann meshUnstructured nutzen,</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">// da nur unstructured Attribut MeshInterface_ besitzt.</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// Jeder Prozessor kennt also das komplette matched Interface</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( this-&gt;getMesh() );</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    vec3D_GO_ptr_Type indicesGlobalMatchedOrigin = meshUnstructured-&gt;getMeshInterface()-&gt;getIndicesGlobalMatchedOrigin();</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// lokale Interface ID, die ich dem Knoten zuschreibe; Wir zaehlen von 0 bis #\Gamma-1</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    GO localInterfaceID = 0; <span class="comment">// long long</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// In diesen beiden Vektoren stehen die Interface IDs in der Interface-Nummerierung,</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// die der Prozessor haelt. Unique!!!</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    vec_GO_Type vecInterfaceMap; <span class="comment">// vec_long ist long long wg. 64</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">// indicesGlobalMatchedOrigin sind die IndicesGlobalMatched von this-Sicht aus.</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// D.h. in indicesGlobalMatchedOrigin.at(0).at(0) ist Fluid GID und</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// indicesGlobalMatchedOrigin.at(0).at(1) ist Struktur GID aus Fluid-Sicht.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// Fluid und Struktur (bzw. this und other) haben gleich viele Interfaceknoten, deswegen</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// muessen wir hier nicht zwischen differenzieren</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// ACHTUNG: indicesGlobalMatchedOrigin ist hier nicht partitioniert!!!!</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; indicesGlobalMatchedOrigin-&gt;size(); i++) <span class="comment">// Schleife ueber jede flag</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; indicesGlobalMatchedOrigin-&gt;at(i).at(0).size(); j++) <span class="comment">// GIDs innerhalb der flag (vom Fluid)</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="comment">// Wir muessen long long anstatt int nutzen, da MyGID auf 64 gestellt ist/ genutzt wird</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            GO globalIDOfInterfaceNode = indicesGlobalMatchedOrigin-&gt;at(i).at(0).at(j);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="comment">// liefert true, falls Proz. GID besitzt</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keywordflow">if</span>( this-&gt;getMapUnique()-&gt;getLocalElement(globalIDOfInterfaceNode) != Teuchos::OrdinalTraits&lt;LO&gt;::invalid())</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <span class="comment">// Schreibe die lokale Interface ID hinein</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                vecInterfaceMap.push_back(localInterfaceID);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            localInterfaceID = localInterfaceID + 1;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// Am Ende steht in localInterfaceID wie viele Interface-Knoten es insgesamt gibt</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    GO numberInterfaceNodes = localInterfaceID; <span class="comment">// long long wg. 64</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">// Baue nun die InterfaceMap (node)</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    std::string ulib = this-&gt;getMapUnique()-&gt;getUnderlyingLib();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    Teuchos::ArrayView&lt;GO&gt; vecInterfaceMapArray =  Teuchos::arrayViewFromVector( vecInterfaceMap );</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    interfaceMapUnique_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( ulib, numberInterfaceNodes, vecInterfaceMapArray, 0, comm_ ) ); <span class="comment">//maybe numberInterfaceNodes instead of -1</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// dof-Map bauen</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    interfaceMapVecFieldUnique_ = interfaceMapUnique_-&gt;buildVecFieldMap(dim_<span class="comment">/*dofs*/</span>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getInterfaceMapUnique()<span class="keyword"> const</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">return</span> interfaceMapUnique_;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getInterfaceMapVecFieldUnique()<span class="keyword"> const</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">return</span> interfaceMapVecFieldUnique_;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getGlobalInterfaceMapUnique()<span class="keyword"> const</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">return</span> globalInterfaceMapUnique_;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getGlobalInterfaceMapVecFieldUnique()<span class="keyword"> const</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">return</span> globalInterfaceMapVecFieldUnique_;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;}</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MapConstPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getOtherGlobalInterfaceMapVecFieldUnique()<span class="keyword"> const</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">return</span> otherGlobalInterfaceMapVecFieldUnique_;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::setPartialCoupling(<span class="keywordtype">int</span> flag, std::string type){</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( this-&gt;getMesh() );</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    meshUnstructured-&gt;getMeshInterface()-&gt;setPartialCoupling(flag, type);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::buildInterfaceMaps()</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;{</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp_dynamic_cast&lt;MeshUnstr_Type&gt;( this-&gt;getMesh() );</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    MeshInterfacePtr_Type <span class="keyword">interface </span>= meshUnstructured-&gt;getMeshInterface();</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    vec3D_GO_ptr_Type indicesMatchedUni = interface-&gt;getIndicesGlobalMatchedUnique();</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    vec3D_GO_ptr_Type indicesMatchedGlobalSerial = interface-&gt;getIndicesGlobalMatchedOrigin();</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    MapConstPtr_Type mapUni = this-&gt;getMapUnique();</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    vec_int_ptr_Type flagPointsUni = this-&gt;getBCFlagUnique();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    vec_GO_Type vecGlobalInterfaceID;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    vec_GO_Type vecOtherGlobalInterfaceID;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    vec_GO_Type vecInterfaceID;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    vec_int_Type vecInterfaceFlag;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    LO localID = 0;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; indicesMatchedGlobalSerial-&gt;size(); i++) <span class="comment">// Schleife ueber jede flag</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; indicesMatchedGlobalSerial-&gt;at(i).at(0).size(); j++) {<span class="comment">// GIDs innerhalb der flag (vom Fluid)</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            LO index = mapUni-&gt;getLocalElement( indicesMatchedGlobalSerial-&gt;at(i).at(0).at(j) );</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="keywordflow">if</span> ( index != Teuchos::OrdinalTraits&lt;LO&gt;::invalid() ){</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                vecGlobalInterfaceID.push_back( indicesMatchedGlobalSerial-&gt;at(i).at(0).at(j) );</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                vecOtherGlobalInterfaceID.push_back( indicesMatchedGlobalSerial-&gt;at(i).at(1).at(j) );</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                vecInterfaceID.push_back( (GO) localID );</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                vecInterfaceFlag.push_back( (*flagPointsUni)[index] );</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            localID++;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">//    std::sort( vecGlobalInterfaceID.begin(), vecGlobalInterfaceID.end() );</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">// Baue nun die InterfaceMap fuer Fluid oder Struktur</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    std::string ulib = this-&gt;getMapUnique()-&gt;getUnderlyingLib();</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    Teuchos::ArrayView&lt;GO&gt; vecInterfaceGlobalMapArray =  Teuchos::arrayViewFromVector( vecGlobalInterfaceID );</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    Teuchos::ArrayView&lt;GO&gt; vecInterfaceMapArray =  Teuchos::arrayViewFromVector( vecInterfaceID );</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    Teuchos::ArrayView&lt;GO&gt; vecOtherInterfaceGlobalMapArray =  Teuchos::arrayViewFromVector( vecOtherGlobalInterfaceID );</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    globalInterfaceMapUnique_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( ulib, -1, vecInterfaceGlobalMapArray, 0, comm_ ) );</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    interfaceMapUnique_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( ulib, -1, vecInterfaceMapArray, 0, comm_ ) );</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    otherGlobalInterfaceMapUnique_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( ulib, -1, vecOtherInterfaceGlobalMapArray, 0, comm_ ) );</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> ( interface-&gt;sizePartialCoupling() == 0 ) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        globalInterfaceMapVecFieldUnique_ = globalInterfaceMapUnique_-&gt;buildVecFieldMap(dim_);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        interfaceMapVecFieldUnique_ = interfaceMapUnique_-&gt;buildVecFieldMap(dim_);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        otherGlobalInterfaceMapVecFieldUnique_ = otherGlobalInterfaceMapUnique_-&gt;buildVecFieldMap(dim_);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">// we add the dofs which are not part of the interface as dummy interface dofs, which do nothing (unit matrix in the diagonal coupling block). We need to do this for the monolithic use of FROSch, since we need a constant number of dofs for a node for each block</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">if</span> (this-&gt;comm_-&gt;getRank() == 0)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;-- ### Warning! Unique and unique-vector-field map might not be compatiable due to partial coupling conditions. ### --&quot;</span>  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordtype">int</span> numDofs = dim_;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="comment">// we use nodewise ordering</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        Teuchos::ArrayView&lt;const GO&gt; elementListGlobal = globalInterfaceMapUnique_-&gt;getNodeElementList();</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        Teuchos::ArrayView&lt;const GO&gt; otherElementListGlobal = otherGlobalInterfaceMapUnique_-&gt;getNodeElementList();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        Teuchos::Array&lt;GO&gt; elementListFieldGlobal( 0 );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        Teuchos::Array&lt;GO&gt; elListFieldPartial( 0 );</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        Teuchos::Array&lt;GO&gt; otherElementListFieldGlobal( 0 );</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        Teuchos::Array&lt;GO&gt; otherElListFieldPartial( 0 );</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">for</span> (UN i=0; i&lt;elementListGlobal.size(); i++) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="keywordtype">int</span> loc = interface-&gt;isPartialCouplingFlag( vecInterfaceFlag[i] );</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">if</span> ( loc &gt; -1 ) {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                std::string partialType = interface-&gt;getPartialCouplingType( loc );</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="keywordflow">if</span> (partialType == <span class="stringliteral">&quot;X_Y&quot;</span> &amp;&amp; dim_ == 3) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    elementListFieldGlobal.push_back (numDofs * elementListGlobal[i] + 0 );</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    elementListFieldGlobal.push_back (numDofs * elementListGlobal[i] + 1 );</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    elementListFieldGlobal.push_back (numDofs * elementListGlobal[i] + 2 );</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    elListFieldPartial.push_back (numDofs * elementListGlobal[i] + 0 );</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    elListFieldPartial.push_back (numDofs * elementListGlobal[i] + 1 );</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                    </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    otherElementListFieldGlobal.push_back (numDofs * otherElementListGlobal[i] + 0 );</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    otherElementListFieldGlobal.push_back (numDofs * otherElementListGlobal[i] + 1 );</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    otherElementListFieldGlobal.push_back (numDofs * otherElementListGlobal[i] + 2 );</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    otherElListFieldPartial.push_back (numDofs * otherElementListGlobal[i] + 0 );</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    otherElListFieldPartial.push_back (numDofs * otherElementListGlobal[i] + 1 );</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, std::runtime_error, <span class="stringliteral">&quot;Implement other partial coupling types.&quot;</span>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <span class="keywordflow">for</span> (UN dof=0; dof&lt;numDofs; dof++){</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    elementListFieldGlobal.push_back(  numDofs * elementListGlobal[i] + dof );</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    elListFieldPartial.push_back ( numDofs * elementListGlobal[i] + dof );</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                    otherElementListFieldGlobal.push_back(  numDofs * otherElementListGlobal[i] + dof );</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                    otherElListFieldPartial.push_back ( numDofs * otherElementListGlobal[i] + dof );</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        globalInterfaceMapVecFieldUnique_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( globalInterfaceMapUnique_-&gt;getUnderlyingLib(), -1, elementListFieldGlobal(), 0<span class="comment">/*index base*/</span>, this-&gt;getComm() ) );</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        otherGlobalInterfaceMapVecFieldUnique_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( globalInterfaceMapUnique_-&gt;getUnderlyingLib(), -1, otherElementListFieldGlobal(), 0<span class="comment">/*index base*/</span>, this-&gt;getComm() ) );</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="comment">// This is only a temporary map. We need to make sure that the dummy values have a higher GID, as the real coupling values. Otherwise we might get a problem during the assembly of the coupling matrices</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        interfaceMapVecFieldUnique_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( globalInterfaceMapUnique_-&gt;getUnderlyingLib(), -1, elementListFieldGlobal.size(), 0<span class="comment">/*index base*/</span>, this-&gt;getComm() ) );</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        partialGlobalInterfaceVecFieldMap_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( interfaceMapUnique_-&gt;getUnderlyingLib(), -1, elListFieldPartial(), 0<span class="comment">/*index base*/</span>, this-&gt;getComm() ) );</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        otherPartialGlobalInterfaceVecFieldMap_ = Teuchos::rcp(<span class="keyword">new</span> Map_Type( interfaceMapUnique_-&gt;getUnderlyingLib(), -1, otherElListFieldPartial(), 0<span class="comment">/*index base*/</span>, this-&gt;getComm() ) );</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::toNodeID(UN dim, GO dofID, GO&amp; nodeID, LO&amp; localDofNumber )</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;{</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    nodeID = (GO) (dofID/dim);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    localDofNumber = (LO) (dofID%dim);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::toDofID(UN dim, GO nodeID, LO localDofNumber, GO&amp; dofID )</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;{</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    dofID = (GO) ( dim * nodeID + localDofNumber);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;vec_long_Type Domain&lt;SC,LO,GO,NO&gt;::getLocalInterfaceIDInGlobal()<span class="keyword"> const</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">return</span> vecLocalInterfaceIDinGlobal_;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keywordtype">void</span> Domain&lt;SC,LO,GO,NO&gt;::setDummyInterfaceDomain(DomainPtr_Type domain)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;{</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    MeshUnstrPtr_Type meshUnstructured = Teuchos::rcp(<span class="keyword">new</span> MeshUnstr_Type(comm_, 10<span class="comment">/*default volume flag*/</span>));</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    mesh_ = meshUnstructured;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    this-&gt;dim_ = domain-&gt;getDimension();</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    this-&gt;mesh_-&gt;mapUnique_ = Teuchos::rcp_const_cast&lt;Map_Type&gt;( domain-&gt;getInterfaceMapUnique() );</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    this-&gt;mesh_-&gt;mapRepeated_ = Teuchos::rcp_const_cast&lt;Map_Type&gt;( domain-&gt;getInterfaceMapUnique() );</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    this-&gt;mapVecFieldRepeated_ = Teuchos::rcp_const_cast&lt;Map_Type&gt;( domain-&gt;getInterfaceMapVecFieldUnique() );</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    this-&gt;mapVecFieldUnique_ = Teuchos::rcp_const_cast&lt;Map_Type&gt;( domain-&gt;getInterfaceMapVecFieldUnique() );</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    MapConstPtr_Type mapGI = domain-&gt;getGlobalInterfaceMapUnique();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    MapConstPtr_Type mapD = domain-&gt;getMapUnique();</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    this-&gt;mesh_-&gt;pointsRep_.reset(<span class="keyword">new</span> std::vector&lt;std::vector&lt;SC&gt; &gt;(mapGI-&gt;getNodeNumElements(), std::vector&lt;SC&gt;(this-&gt;dim_, 0.0 ) ) );</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    this-&gt;mesh_-&gt;pointsUni_.reset(<span class="keyword">new</span> std::vector&lt;std::vector&lt;SC&gt; &gt;(mapGI-&gt;getNodeNumElements(), std::vector&lt;SC&gt;(this-&gt;dim_, 0.0 ) ) );</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    vec2D_dbl_ptr_Type pointsUni = domain-&gt;getPointsUnique();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;mapGI-&gt;getNodeNumElements(); i++) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        LO index = mapD-&gt;getLocalElement( mapGI-&gt;getGlobalElement( i ) );</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;this-&gt;dim_; j++){</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            (*this-&gt;mesh_-&gt;pointsRep_)[i][j] = (*pointsUni)[index][j];</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            (*this-&gt;mesh_-&gt;pointsUni_)[i][j] = (*pointsUni)[index][j];</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">//template &lt;class SC, class LO, class GO, class NO&gt;</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">//void Domain&lt;SC,LO,GO,NO&gt;::setDummyInterfaceMesh( MeshPtr_Type mesh )</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">//{</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">//    this-&gt;mesh_ = mesh;</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="keywordtype">int</span> Domain&lt;SC,LO,GO,NO&gt;::findInPointsUnique(<span class="keyword">const</span> vec_dbl_Type&amp; x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordtype">double</span> eps = 0.0000001;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    vec2D_dbl_ptr_Type points = this-&gt;getPointsUnique();</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (this-&gt;getDimension()==2) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keyword">auto</span> iterator = std::find_if( points-&gt;begin(), points-&gt;end(),</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                     [&amp;] (<span class="keyword">const</span> vector&lt;double&gt;&amp; a){</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                         if (a[0] &gt;= x[0]-eps &amp;&amp; a[0] &lt;= x[0]+eps</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                             &amp;&amp; a[1] &gt;= x[1]-eps &amp;&amp; a[1] &lt;= x[1]+eps)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                             return true;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                         else</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                             return false;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                     }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                     );</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">if</span> ( iterator != points-&gt;end() )</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="keywordflow">return</span> std::distance(points-&gt;begin(),iterator);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;             <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;getDimension()==3) {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keyword">auto</span> iterator = std::find_if(points-&gt;begin(),points-&gt;end(),</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                     [&amp;] (<span class="keyword">const</span> vector&lt;double&gt;&amp; a){</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                         if (a[0] &gt;= x[0]-eps &amp;&amp; a[0] &lt;= x[0]+eps</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                             &amp;&amp; a[1] &gt;= x[1]-eps &amp;&amp; a[1] &lt;= x[1]+eps</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                             &amp;&amp; a[2] &gt;= x[2]-eps &amp;&amp; a[2] &lt;= x[2]+eps)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                             return true;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                         else</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                             return false;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                     }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                     );</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">if</span> ( iterator != points-&gt;end() )</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="keywordflow">return</span> std::distance(points-&gt;begin(),iterator);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;}</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> SC, <span class="keyword">class</span> LO, <span class="keyword">class</span> GO, <span class="keyword">class</span> NO&gt;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="keyword">typename</span> Domain&lt;SC,LO,GO,NO&gt;::MultiVectorPtr_Type Domain&lt;SC,LO,GO,NO&gt;::getNodeListMV()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    MapConstPtr_Type map = this-&gt;getMapRepeated();</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    MultiVectorPtr_Type nodeList = Teuchos::rcp( <span class="keyword">new</span> MultiVector_Type ( map, dim_ ) );</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    vec2D_dbl_ptr_Type pointsRepeated = this-&gt;getPointsRepeated();</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nodeList-&gt;getLocalLength(); i++) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;dim_; j++) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            Teuchos::ArrayRCP&lt; SC &gt; values = nodeList-&gt;getDataNonConst( j );</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            values[i] = (*pointsRepeated)[i][j];</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">return</span> nodeList;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;}</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;}</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceFEDD_html"><div class="ttname"><a href="../../d0/dac/namespaceFEDD.html">FEDD</a></div><div class="ttdoc">Domain.</div><div class="ttdef"><b>Definition:</b> AssembleFE_decl.hpp:9</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
